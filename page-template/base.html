<!--
SPDX-License-Identifier: GPL-3.0-or-later
SynapSeq Hub Frontend Template
Copyright (C) 2025 SynapSeq Project Contributors

This file is part of SynapSeq Hub.
Licensed under the GNU General Public License v3.0 or later.
See the LICENSE_CODE file for full license text.

You should have received a copy of the GNU General Public License
along with this program. If not, see <https://www.gnu.org/licenses/>.
-->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SynapSeq Hub</title>
    <link rel="icon" type="image/x-icon" href="static/favicon.ico" />
    <link rel="stylesheet" href="static/style.css" />
  </head>
  <body class="light">
    <header>
      <div class="header-title">
        <img src="static/logo.png" alt="SynapSeq Logo" class="logo" />
        <h1>SynapSeq Hub</h1>
      </div>
      <button id="themeToggle" class="theme-toggle">
        <svg
          class="theme-icon moon-icon"
          width="20"
          height="20"
          viewBox="0 0 20 20"
          fill="none"
        >
          <path
            d="M17 10.5C16.1 14.8 12.4 18 8 18C3.6 18 0 14.4 0 10C0 5.6 3.2 1.9 7.5 1C6.6 2.1 6 3.5 6 5C6 8.3 8.7 11 12 11C13.5 11 14.9 10.4 16 9.5C16.7 9.8 17 10.1 17 10.5Z"
            fill="currentColor"
          />
        </svg>
        <svg
          class="theme-icon bulb-icon"
          width="20"
          height="20"
          viewBox="0 0 20 20"
          fill="none"
          style="display: none"
        >
          <path
            d="M10 2C10 1.4 9.6 1 9 1C8.4 1 8 1.4 8 2V3C8 3.6 8.4 4 9 4C9.6 4 10 3.6 10 3V2Z"
            fill="currentColor"
          />
          <path
            d="M15 10C15 12.8 12.8 15 10 15C10 15.6 9.6 16 9 16H7C6.4 16 6 16.4 6 17C6 17.6 6.4 18 7 18H11C11.6 18 12 17.6 12 17C12 16.4 11.6 16 11 16C11 16 11 15.5 11 15C13.9 15 16.2 12.7 16.2 9.8C16.2 6.9 13.9 4.6 11 4.6V3.8C11 3.2 10.6 2.8 10 2.8C9.4 2.8 9 3.2 9 3.8V4.6C6.1 4.6 3.8 6.9 3.8 9.8C3.8 12.7 6.1 15 9 15V16C8.4 16 8 16.4 8 17C8 17.6 8.4 18 9 18H13C13.6 18 14 17.6 14 17C14 16.4 13.6 16 13 16H12C12 15.5 12 15 12 15C14.8 15 17 12.8 17 10C17 7.2 14.8 5 12 5C12 4.4 11.6 4 11 4C10.4 4 10 4.4 10 5C7.2 5 5 7.2 5 10C5 12.8 7.2 15 10 15Z"
            fill="currentColor"
          />
          <circle cx="10" cy="10" r="4" fill="currentColor" />
          <path
            d="M10 1C10.6 1 11 1.4 11 2V3C11 3.6 10.6 4 10 4C9.4 4 9 3.6 9 3V2C9 1.4 9.4 1 10 1Z"
            fill="currentColor"
          />
          <path
            d="M16.7 4.7C17.1 4.3 17.7 4.3 18.1 4.7C18.5 5.1 18.5 5.7 18.1 6.1L17.4 6.8C17 7.2 16.4 7.2 16 6.8C15.6 6.4 15.6 5.8 16 5.4L16.7 4.7Z"
            fill="currentColor"
          />
          <path
            d="M19 10C19 9.4 18.6 9 18 9H17C16.4 9 16 9.4 16 10C16 10.6 16.4 11 17 11H18C18.6 11 19 10.6 19 10Z"
            fill="currentColor"
          />
          <path
            d="M16.7 15.3L17.4 14.6C17.8 14.2 18.4 14.2 18.8 14.6C19.2 15 19.2 15.6 18.8 16L18.1 16.7C17.7 17.1 17.1 17.1 16.7 16.7C16.3 16.3 16.3 15.7 16.7 15.3Z"
            fill="currentColor"
          />
          <path
            d="M3.3 15.3C2.9 15.7 2.3 15.7 1.9 15.3C1.5 14.9 1.5 14.3 1.9 13.9L2.6 13.2C3 12.8 3.6 12.8 4 13.2C4.4 13.6 4.4 14.2 4 14.6L3.3 15.3Z"
            fill="currentColor"
          />
          <path
            d="M1 10C1 10.6 1.4 11 2 11H3C3.6 11 4 10.6 4 10C4 9.4 3.6 9 3 9H2C1.4 9 1 9.4 1 10Z"
            fill="currentColor"
          />
          <path
            d="M3.3 4.7L2.6 5.4C2.2 5.8 1.6 5.8 1.2 5.4C0.8 5 0.8 4.4 1.2 4L1.9 3.3C2.3 2.9 2.9 2.9 3.3 3.3C3.7 3.7 3.7 4.3 3.3 4.7Z"
            fill="currentColor"
          />
        </svg>
        <span class="theme-text">Dark Mode</span>
      </button>
    </header>

    <div id="stats">
      <div class="stat-card">
        <div class="stat-icon">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path
              d="M3 5h14M3 10h14M3 15h14"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
        </div>
        <div class="stat-content">
          <span class="stat-label">Total sequences</span>
          <span class="stat-value">{{total}}</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <circle
              cx="10"
              cy="10"
              r="7"
              stroke="currentColor"
              stroke-width="2"
            />
            <path
              d="M10 6v4l3 2"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
        </div>
        <div class="stat-content">
          <span class="stat-label">Last updated</span>
          <span
            class="stat-value"
            id="lastUpdated"
            data-timestamp="{{last_updated}}"
            title="{{last_updated}}"
          >
            {{last_updated}}
          </span>
        </div>
      </div>
    </div>

    <div class="search-wrapper">
      <input type="text" id="search" placeholder="Search sequences..." />
      <button
        id="clearSearch"
        class="clear-search"
        onclick="clearSearch()"
        style="display: none"
      >
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path
            d="M12 4L4 12M4 4l8 8"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
          />
        </svg>
      </button>
    </div>

    <button class="toggle-filters-btn" onclick="toggleFilters()">
      <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
        <path
          d="M2 4h14M4 9h10M6 14h6"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
        />
      </svg>
      <span>Advanced Filters</span>
      <svg
        class="chevron"
        width="16"
        height="16"
        viewBox="0 0 16 16"
        fill="none"
      >
        <path
          d="M4 6l4 4 4-4"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>

    <div id="advancedFilters" class="advanced-filters" style="display: none">
      <div class="filter-group">
        <label for="filterCategory">Category</label>
        <select id="filterCategory" onchange="applyFilters()">
          <option value="">All</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="filterAuthor">Author</label>
        <select id="filterAuthor" onchange="applyFilters()">
          <option value="">All</option>
        </select>
      </div>

      <button class="clear-filters-btn" onclick="clearFilters()">
        Clear All Filters
      </button>
    </div>

    <table id="seqTable">
      <thead>
        <tr>
          <th>Name</th>
          <th>Category</th>
          <th>Author</th>
          <th>Updated</th>
        </tr>
      </thead>
      <tbody>
        {{rows}}
      </tbody>
    </table>

    <div id="viewer" style="display: none">
      <button class="back-btn" onclick="backToList()">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <path
            d="M12.5 15L7.5 10L12.5 5"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
        Back
      </button>

      <div id="loading" class="loading">
        <div class="spinner"></div>
        <p>Loading sequence...</p>
      </div>

      <div id="seqMeta">
        <div class="cli-command">
          <p><strong>Run this sequence via CLI:</strong></p>
          <div class="cli-wrapper">
            <code id="cliCommand"></code>
            <button
              id="copyBtnDesktop"
              class="copy-btn copy-btn-desktop"
              onclick="copyCommand()"
            >
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <rect
                  x="4"
                  y="4"
                  width="8"
                  height="10"
                  rx="1"
                  stroke="currentColor"
                  stroke-width="1.5"
                />
                <path
                  d="M12 4V2.5C12 1.67 11.33 1 10.5 1H5.5C4.67 1 4 1.67 4 2.5V4"
                  stroke="currentColor"
                  stroke-width="1.5"
                />
              </svg>
              <span>Copy</span>
            </button>
          </div>
          <button
            id="copyBtnMobile"
            class="copy-btn copy-btn-mobile"
            onclick="copyCommand()"
          >
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <rect
                x="4"
                y="4"
                width="8"
                height="10"
                rx="1"
                stroke="currentColor"
                stroke-width="1.5"
              />
              <path
                d="M12 4V2.5C12 1.67 11.33 1 10.5 1H5.5C4.67 1 4 1.67 4 2.5V4"
                stroke="currentColor"
                stroke-width="1.5"
              />
            </svg>
            <span>Copy</span>
          </button>
        </div>

        <div id="seqDescription" style="display: none">
          <h3>Description</h3>
          <div id="descriptionContent" class="description-content"></div>
          <button
            id="toggleDescription"
            class="read-more-btn"
            onclick="toggleDescription()"
            style="display: none"
          >
            Read more
          </button>
        </div>
      </div>

      <div id="dependenciesSection" style="display: none">
        <button
          id="toggleDependencies"
          class="toggle-dependencies-btn"
          onclick="toggleDependencies()"
        >
          <svg
            width="16"
            height="16"
            viewBox="0 0 16 16"
            fill="none"
            class="chevron"
          >
            <path
              d="M4 6l4 4 4-4"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          <span>Show dependencies</span>
        </button>
        <div id="seqInfo" style="display: none"></div>
      </div>

      <div id="sourceCodeSection" style="display: none">
        <button
          id="toggleSourceCode"
          class="toggle-source-btn"
          onclick="toggleSourceCode()"
        >
          <svg
            width="16"
            height="16"
            viewBox="0 0 16 16"
            fill="none"
            class="chevron"
          >
            <path
              d="M4 6l4 4 4-4"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          <span>Show source code</span>
        </button>
        <pre id="seqCode" style="display: none"></pre>
      </div>

      <div id="buttons">
        <button id="downloadZipBtn" onclick="handleDownloadClick()">
          Download Sequence
        </button>
      </div>
    </div>

    <!-- Download Modal -->
    <div id="downloadModal" class="modal" style="display: none">
      <div class="modal-content">
        <button class="modal-close" onclick="closeDownloadModal()">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path
              d="M15 5L5 15M5 5l10 10"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
        </button>

        <h2>Download Instructions</h2>

        <div class="instructions">
          <h3>After downloading, follow these steps:</h3>

          <div class="step">
            <span class="step-number">1</span>
            <div class="step-content">
              <p><strong>Extract the ZIP file:</strong></p>
              <p class="step-label">Windows (PowerShell):</p>
              <div class="code-wrapper">
                <code id="unzipWindows"></code>
                <button
                  class="copy-code-btn"
                  onclick="copyCode('unzipWindows')"
                >
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <rect
                      x="4"
                      y="4"
                      width="8"
                      height="10"
                      rx="1"
                      stroke="currentColor"
                      stroke-width="1.5"
                    />
                    <path
                      d="M12 4V2.5C12 1.67 11.33 1 10.5 1H5.5C4.67 1 4 1.67 4 2.5V4"
                      stroke="currentColor"
                      stroke-width="1.5"
                    />
                  </svg>
                </button>
              </div>
              <p class="step-label">macOS / Linux:</p>
              <div class="code-wrapper">
                <code id="unzipUnix"></code>
                <button class="copy-code-btn" onclick="copyCode('unzipUnix')">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <rect
                      x="4"
                      y="4"
                      width="8"
                      height="10"
                      rx="1"
                      stroke="currentColor"
                      stroke-width="1.5"
                    />
                    <path
                      d="M12 4V2.5C12 1.67 11.33 1 10.5 1H5.5C4.67 1 4 1.67 4 2.5V4"
                      stroke="currentColor"
                      stroke-width="1.5"
                    />
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <div class="step">
            <span class="step-number">2</span>
            <div class="step-content">
              <p><strong>Navigate to the extracted folder:</strong></p>
              <div class="code-wrapper">
                <code id="cdCommand"></code>
                <button class="copy-code-btn" onclick="copyCode('cdCommand')">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <rect
                      x="4"
                      y="4"
                      width="8"
                      height="10"
                      rx="1"
                      stroke="currentColor"
                      stroke-width="1.5"
                    />
                    <path
                      d="M12 4V2.5C12 1.67 11.33 1 10.5 1H5.5C4.67 1 4 1.67 4 2.5V4"
                      stroke="currentColor"
                      stroke-width="1.5"
                    />
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <div class="step">
            <span class="step-number">3</span>
            <div class="step-content">
              <p><strong>Generate the WAV file:</strong></p>
              <div class="code-wrapper">
                <code id="generateCommand"></code>
                <button
                  class="copy-code-btn"
                  onclick="copyCode('generateCommand')"
                >
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <rect
                      x="4"
                      y="4"
                      width="8"
                      height="10"
                      rx="1"
                      stroke="currentColor"
                      stroke-width="1.5"
                    />
                    <path
                      d="M12 4V2.5C12 1.67 11.33 1 10.5 1H5.5C4.67 1 4 1.67 4 2.5V4"
                      stroke="currentColor"
                      stroke-width="1.5"
                    />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>

        <button id="downloadBtn" class="download-btn" onclick="downloadZip()">
          <span id="downloadBtnText"
            >Download starting in <strong id="countdownText">3</strong>...</span
          >
        </button>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/relativeTime.js"></script>
    <script src="static/main.js"></script>
  </body>
</html>
